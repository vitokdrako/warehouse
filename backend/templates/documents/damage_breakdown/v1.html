<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–æ–∑—à–∏—Ñ—Ä–æ–≤–∫–∞ –ø–æ—à–∫–æ–¥–∂–µ–Ω—å - {{ order.order_number }}</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'DejaVu Sans', Arial, sans-serif;
            font-size: 12px;
            line-height: 1.4;
            color: #333;
            padding: 20px;
            background: #fff;
        }
        .header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f59e0b;
        }
        .header h1 {
            font-size: 20px;
            font-weight: bold;
            color: #d97706;
            margin-bottom: 5px;
        }
        .header .subtitle {
            font-size: 14px;
            color: #666;
        }
        .header .order-info {
            margin-top: 10px;
            font-size: 13px;
        }
        .info-block {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            gap: 20px;
        }
        .info-section {
            flex: 1;
            padding: 12px;
            background: #fffbeb;
            border: 1px solid #fcd34d;
            border-radius: 8px;
        }
        .info-section h3 {
            font-size: 11px;
            font-weight: bold;
            margin-bottom: 8px;
            color: #92400e;
            text-transform: uppercase;
        }
        .info-section p {
            margin: 4px 0;
            font-size: 11px;
        }
        .damage-item {
            margin-bottom: 20px;
            padding: 15px;
            background: #fef3c7;
            border: 1px solid #fbbf24;
            border-radius: 10px;
            page-break-inside: avoid;
        }
        .damage-item.critical {
            background: #fee2e2;
            border-color: #ef4444;
        }
        .damage-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
            padding-bottom: 10px;
            border-bottom: 1px dashed #d97706;
        }
        .damage-header .product-info h4 {
            font-size: 14px;
            font-weight: bold;
            color: #92400e;
        }
        .damage-header .product-info .sku {
            font-size: 11px;
            color: #666;
            margin-top: 2px;
        }
        .damage-header .severity {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
            text-transform: uppercase;
        }
        .severity-low { background: #d1fae5; color: #065f46; }
        .severity-medium { background: #fef3c7; color: #92400e; }
        .severity-high { background: #fee2e2; color: #991b1b; }
        .severity-critical { background: #7f1d1d; color: #fff; }
        
        .damage-content {
            display: flex;
            gap: 15px;
        }
        .damage-photo {
            flex-shrink: 0;
        }
        .damage-photo img {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            border: 2px solid #fbbf24;
        }
        .damage-photo .no-photo {
            width: 150px;
            height: 150px;
            background: #f3f4f6;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #9ca3af;
            font-size: 11px;
        }
        .damage-details {
            flex: 1;
        }
        .damage-type {
            font-size: 13px;
            font-weight: bold;
            color: #d97706;
            margin-bottom: 8px;
        }
        .damage-note {
            font-size: 12px;
            color: #374151;
            padding: 8px;
            background: #fff;
            border-radius: 6px;
            margin-bottom: 8px;
        }
        .damage-meta {
            font-size: 10px;
            color: #6b7280;
            display: flex;
            gap: 15px;
        }
        .damage-meta span {
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .summary {
            margin-top: 25px;
            padding: 15px;
            background: #fef3c7;
            border: 2px solid #f59e0b;
            border-radius: 10px;
        }
        .summary h3 {
            font-size: 14px;
            color: #92400e;
            margin-bottom: 10px;
        }
        .summary-stats {
            display: flex;
            gap: 20px;
        }
        .summary-stat {
            text-align: center;
            padding: 10px 20px;
            background: #fff;
            border-radius: 8px;
        }
        .summary-stat .number {
            font-size: 24px;
            font-weight: bold;
            color: #d97706;
        }
        .summary-stat .label {
            font-size: 10px;
            color: #666;
            margin-top: 4px;
        }
        
        .notice {
            margin-top: 20px;
            padding: 12px;
            background: #dbeafe;
            border: 1px solid #3b82f6;
            border-radius: 8px;
            font-size: 11px;
            color: #1e40af;
        }
        .notice strong {
            display: block;
            margin-bottom: 5px;
        }
        
        .footer {
            margin-top: 30px;
            padding-top: 15px;
            border-top: 1px solid #e5e7eb;
            font-size: 10px;
            color: #6b7280;
            text-align: center;
        }
        
        .signatures {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
        }
        .signature-block {
            width: 45%;
        }
        .signature-line {
            border-bottom: 1px solid #333;
            margin-top: 30px;
            margin-bottom: 5px;
        }
        .signature-label {
            font-size: 10px;
            color: #666;
        }
        
        @media print {
            body { padding: 10px; }
            .damage-item { page-break-inside: avoid; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>‚ö†Ô∏è –†–û–ó–®–ò–§–†–û–í–ö–ê –ü–û–®–ö–û–î–ñ–ï–ù–¨</h1>
        <div class="subtitle">–ê–∫—Ç —Ñ—ñ–∫—Å–∞—Ü—ñ—ó —ñ—Å–Ω—É—é—á–∏—Ö –¥–µ—Ñ–µ–∫—Ç—ñ–≤ –ø—Ä–∏ –≤–∏–¥–∞—á—ñ</div>
        <div class="order-info">
            <strong>–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è {{ order.order_number }}</strong> ¬∑ {{ order.rental_start_date }} ‚Äî {{ order.rental_end_date }}
        </div>
    </div>

    <div class="info-block">
        <div class="info-section">
            <h3>üë§ –ö–ª—ñ—î–Ω—Ç</h3>
            <p><strong>{{ order.customer_name }}</strong></p>
            <p>üìû {{ order.customer_phone }}</p>
            {% if order.customer_email %}
            <p>üìß {{ order.customer_email }}</p>
            {% endif %}
        </div>
        <div class="info-section">
            <h3>üìÖ –ü–µ—Ä—ñ–æ–¥ –æ—Ä–µ–Ω–¥–∏</h3>
            <p><strong>{{ order.rental_days }} –¥–Ω—ñ–≤</strong></p>
            <p>–ó: {{ order.rental_start_date }}</p>
            <p>–î–æ: {{ order.rental_end_date }}</p>
        </div>
    </div>

    {% if damages %}
    <div class="damages-list">
        {% for damage in damages %}
        <div class="damage-item {% if damage.severity == 'critical' %}critical{% endif %}">
            <div class="damage-header">
                <div class="product-info">
                    <h4>{{ damage.product_name }}</h4>
                    <div class="sku">–ê—Ä—Ç–∏–∫—É–ª: {{ damage.sku or 'N/A' }}</div>
                </div>
                <span class="severity severity-{{ damage.severity }}">
                    {% if damage.severity == 'low' %}–Ω–µ–∑–Ω–∞—á–Ω–∏–π
                    {% elif damage.severity == 'medium' %}—Å–µ—Ä–µ–¥–Ω—ñ–π
                    {% elif damage.severity == 'high' %}—Å—É—Ç—Ç—î–≤–∏–π
                    {% else %}–∫—Ä–∏—Ç–∏—á–Ω–∏–π{% endif %}
                </span>
            </div>
            
            <div class="damage-content">
                <div class="damage-photo">
                    {% if damage.photo_url %}
                    <img src="{{ backend_url }}/{{ damage.photo_url }}" alt="–§–æ—Ç–æ –ø–æ—à–∫–æ–¥–∂–µ–Ω–Ω—è" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                    <div class="no-photo" style="display:none;">üì∑ –ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</div>
                    {% else %}
                    <div class="no-photo">üì∑ –ë–µ–∑ —Ñ–æ—Ç–æ</div>
                    {% endif %}
                </div>
                <div class="damage-details">
                    <div class="damage-type">{{ damage.damage_type }}</div>
                    {% if damage.note %}
                    <div class="damage-note">{{ damage.note }}</div>
                    {% endif %}
                    <div class="damage-meta">
                        <span>üë§ {{ damage.created_by or '–°–∏—Å—Ç–µ–º–∞' }}</span>
                        <span>üìÖ {{ damage.created_at }}</span>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="summary">
        <h3>üìä –ü—ñ–¥—Å—É–º–æ–∫</h3>
        <div class="summary-stats">
            <div class="summary-stat">
                <div class="number">{{ damages|length }}</div>
                <div class="label">–ó–∞—Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ –¥–µ—Ñ–µ–∫—Ç—ñ–≤</div>
            </div>
            <div class="summary-stat">
                <div class="number">{{ items_with_damage }}</div>
                <div class="label">–ü–æ–∑–∏—Ü—ñ–π –∑ –¥–µ—Ñ–µ–∫—Ç–∞–º–∏</div>
            </div>
            <div class="summary-stat">
                <div class="number">{{ total_items }}</div>
                <div class="label">–í—Å—å–æ–≥–æ –ø–æ–∑–∏—Ü—ñ–π</div>
            </div>
        </div>
    </div>
    {% else %}
    <div class="notice" style="background: #d1fae5; border-color: #10b981; color: #065f46;">
        <strong>‚úÖ –ü–æ—à–∫–æ–¥–∂–µ–Ω—å –Ω–µ –∑–∞—Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ</strong>
        –í—Å—ñ –ø–æ–∑–∏—Ü—ñ—ó –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤–∏–¥–∞—é—Ç—å—Å—è –±–µ–∑ –¥–µ—Ñ–µ–∫—Ç—ñ–≤.
    </div>
    {% endif %}

    <div class="notice">
        <strong>‚ÑπÔ∏è –í–∞–∂–ª–∏–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è</strong>
        –î–µ—Ñ–µ–∫—Ç–∏, –∑–∞—Ñ—ñ–∫—Å–æ–≤–∞–Ω—ñ –≤ —Ü—å–æ–º—É –∞–∫—Ç—ñ, —î —ñ—Å–Ω—É—é—á–∏–º–∏ –Ω–∞ –º–æ–º–µ–Ω—Ç –≤–∏–¥–∞—á—ñ –¥–µ–∫–æ—Ä—É –∫–ª—ñ—î–Ω—Ç—É.
        –ö–ª—ñ—î–Ω—Ç –ù–ï –Ω–µ—Å–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ –∑–∞ —Ü—ñ –ø–æ—à–∫–æ–¥–∂–µ–Ω–Ω—è –ø—Ä–∏ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—ñ.
        –ü—Ä–∏ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—ñ –±—É–¥–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Å—Ç–∞–Ω—É –¥–µ–∫–æ—Ä—É –∑ —Ü–∏–º –∞–∫—Ç–æ–º.
    </div>

    <div class="signatures">
        <div class="signature-block">
            <strong>–ü—Ä–µ–¥—Å—Ç–∞–≤–Ω–∏–∫ {{ company.name }}:</strong>
            <div class="signature-line"></div>
            <div class="signature-label">–ü—ñ–¥–ø–∏—Å / –ü–Ü–ë</div>
        </div>
        <div class="signature-block">
            <strong>–ö–ª—ñ—î–Ω—Ç:</strong>
            <div class="signature-line"></div>
            <div class="signature-label">–ü—ñ–¥–ø–∏—Å / –ü–Ü–ë</div>
        </div>
    </div>

    <div class="footer">
        <p><strong>{{ company.name }}</strong> ¬∑ {{ company.legal_name }}</p>
        <p>–î–æ–∫—É–º–µ–Ω—Ç —Å—Ñ–æ—Ä–º–æ–≤–∞–Ω–æ: {{ generated_at }}</p>
    </div>
</body>
</html>
