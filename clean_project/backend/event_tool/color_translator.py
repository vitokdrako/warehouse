# Словник для перекладу російських назв кольорів на українські
COLOR_TRANSLATION = {
    # Російською: Українською
    'белый': 'білий',
    'Белый': 'білий',
    'белая': 'біла',
    'Белая': 'біла',
    'Біла': 'біла',
    'черный': 'чорний',
    'Черный': 'чорний',
    'красный': 'червоний',
    'Красный': 'червоний',
    'синий': 'синій',
    'Синий': 'синій',
    'зеленый': 'зелений',
    'Зеленый': 'зелений',
    'желтый': 'жовтий',
    'Желтый': 'жовтий',
    'голубой': 'блакитний',
    'Голубой': 'блакитний',
    'розовый': 'рожевий',
    'Розовый': 'рожевий',
    'серый': 'сірий',
    'Серый': 'сірий',
    'коричневый': 'коричневий',
    'Коричневый': 'коричневий',
    'оранжевый': 'помаранчевий',
    'Оранжевый': 'помаранчевий',
    'фиолетовый': 'фіолетовий',
    'Фиолетовый': 'фіолетовий',
    'золото': 'золотий',
    'Золото': 'золотий',
    'золотой': 'золотий',
    'Золотой': 'золотий',
    'серебро': 'срібло',
    'Серебро': 'срібло',
    'cеребро': 'срібло',  # typo in DB
    'медь': 'мідь',
    'Медь': 'мідь',
    'прозрачный': 'прозорий',
    'Прозрачный': 'прозорий',
    'бежевый': 'бежевий',
    'Бежевый': 'бежевий',
    'beg': 'бежевий',
    'бордовый': 'бордовий',
    'Бордовый': 'бордовий',
    'зеркало': 'дзеркало',
    'Зеркало': 'дзеркало',
    'горчичный': 'гірчичний',
    'Горчичный': 'гірчичний',
    'салатовый': 'салатовий',
    'Салатовый': 'салатовий',
    'персиковый': 'персиковий',
    'Персиковый': 'персиковий',
    'оливковый': 'оливковий',
    'Оливковый': 'оливковий',
    'лиловый': 'ліловий',
    'Лиловый': 'ліловий',
    'малиновый': 'малиновий',
    'Малиновый': 'малиновий',
    'рисунок': 'малюнок',
    'Рисунок': 'малюнок',
    'разноцветный': 'різнокольоровий',
    'Разноцветный': 'різнокольоровий',
    'цветной': 'кольоровий',
    'Цветной': 'кольоровий',
    'нежно-розовый': 'ніжно-рожевий',
    'Нежно-розовый': 'ніжно-рожевий',
    'светло-серый': 'світло-сірий',
    'Светло-серый': 'світло-сірий',
    'пудровый': 'пудровий',
    'Пудровый': 'пудровий',
    'сиреневый': 'бузковий',
    'Сиреневый': 'бузковий',
    'терракот': 'теракот',
    'Терракот': 'теракот',
    'терракотовый': 'теракотовий',
    'Терракотовый': 'теракотовий',
    'лимонный': 'лимонний',
    'Лимонный': 'лимонний',
    'стально-голубой': 'стально-блакитний',
    'Стально-голубой': 'стально-блакитний',
    'синий перламутр': 'синій перламутр',
    'Синий перламутр': 'синій перламутр',
    'темно розовый': 'темно-рожевий',
    'Темно розовый': 'темно-рожевий',
    'темно синий': 'темно-синій',
    'Темно синий': 'темно-синій',
    'стекло': 'скло',
    'Стекло': 'скло',
    'шоколодный': 'шоколадний',
    'Шоколодный': 'шоколадний',
    'сизый': 'сизий',
    'Сизый': 'сизий',
    'голубая акварель': 'блакитна акварель',
    'Голубая акварель': 'блакитна акварель',
    'коричневый. золото': 'коричневий, золотий',
    'Коричневый. золото': 'коричневий, золотий',
    'белый\nзеленый\nкрасный': 'білий, зелений, червоний',
    'белыйзеленыйкрасный': 'білий, зелений, червоний',
}

def translate_color(color_value: str) -> str:
    """
    Перекладає назву кольору з російської на українську.
    Обробляє одиничні кольори та списки кольорів через кому.
    
    Args:
        color_value: Назва кольору або список кольорів через кому
        
    Returns:
        Перекладена назва кольору українською
    """
    if not color_value:
        return color_value
    
    # Якщо є кома - це список кольорів
    if ',' in color_value:
        colors = [c.strip() for c in color_value.split(',')]
        translated = []
        for c in colors:
            # Спочатку перевіряємо прямий переклад
            if c in COLOR_TRANSLATION:
                translated.append(COLOR_TRANSLATION[c])
            # Якщо немає перекладу - залишаємо як є (можливо вже українською)
            elif c:
                translated.append(c)
        return ', '.join(translated)
    
    # Одиничний колір
    cleaned = color_value.strip()
    
    # Перевірка прямого перекладу
    if cleaned in COLOR_TRANSLATION:
        return COLOR_TRANSLATION[cleaned]
    
    # Якщо немає в словнику - повертаємо як є
    return cleaned


def get_all_unique_colors_ukrainian(products_with_colors: list) -> list:
    """
    Витягує всі унікальні кольори з товарів і перекладає їх українською.
    
    Args:
        products_with_colors: Список товарів з полем color
        
    Returns:
        Відсортований список унікальних кольорів українською
    """
    colors_set = set()
    
    for product in products_with_colors:
        if product.color:
            # Перекладаємо колір
            translated = translate_color(product.color)
            # Розбиваємо по комах якщо є
            if ',' in translated:
                for c in translated.split(','):
                    cleaned = c.strip()
                    if cleaned and cleaned != 'ї':  # Пропускаємо невалідні значення
                        colors_set.add(cleaned)
            else:
                cleaned = translated.strip()
                if cleaned and cleaned != 'ї':
                    colors_set.add(cleaned)
    
    # Сортуємо українською
    return sorted(list(colors_set), key=lambda x: x.lower())
