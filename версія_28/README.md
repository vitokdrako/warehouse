# –í–µ—Ä—Å—ñ—è 28 - 29.12.2025

## –©–æ –Ω–æ–≤–æ–≥–æ:

### 1. –í–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π —á–∞—Ç –∫–æ–º–∞–Ω–¥–∏ üí¨
- –ù–æ–≤–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `InternalNotesChat` –¥–ª—è —Å–ø—ñ–ª–∫—É–≤–∞–Ω–Ω—è –º—ñ–∂ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞–º–∏
- –ö–æ–∂–Ω–∞ –Ω–æ—Ç–∞—Ç–∫–∞ –ø–æ–∫–∞–∑—É—î –∞–≤—Ç–æ—Ä–∞ (–∑ —Å–∏—Å—Ç–µ–º–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó) —Ç–∞ —á–∞—Å
- –ö–æ–º–µ–Ω—Ç–∞—Ä –∫–ª—ñ—î–Ω—Ç–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –æ–∫—Ä–µ–º–æ (read-only)
- –î–æ—Å—Ç—É–ø–Ω–∏–π –Ω–∞ –≤—Å—ñ—Ö –µ—Ç–∞–ø–∞—Ö –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è

### 2. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–æ—Ç–æ –ø–æ—à–∫–æ–¥–∂–µ–Ω—å üì∑
- –ù–æ–≤–∏–π endpoint `POST /api/product-damage-history/upload-photo`
- –§–æ—Ç–æ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –∑ —ñ–º–µ–Ω–µ–º: `{order_number}_{sku}_{timestamp}.jpg`
- –ü—Ä–∏–∫–ª–∞–¥: `OC-7217_PLATE-GOLD-001_20251228_143000.jpg`

### 3. –î–æ–∫—É–º–µ–Ω—Ç "–†–æ–∑—à–∏—Ñ—Ä–æ–≤–∫–∞ –ø–æ—à–∫–æ–¥–∂–µ–Ω—å" üìÑ
- –ù–æ–≤–∏–π —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞ `damage_breakdown`
- –ü–æ–∫–∞–∑—É—î –≤—Å—ñ pre_issue –ø–æ—à–∫–æ–¥–∂–µ–Ω–Ω—è –∑ —Ñ–æ—Ç–æ
- –î–æ—Å—Ç—É–ø–Ω–∏–π –Ω–∞ –µ—Ç–∞–ø–∞—Ö: ready_for_issue, issued, on_rent, returning, returned, completed
- –ú–æ–∂–Ω–∞ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∫–ª—ñ—î–Ω—Ç—É –Ω–∞ email

### 4. –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –∑–º—ñ–Ω –º—ñ–∂ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ üîÑ
- –ü—Ä–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è timestamp –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
- –Ü–Ω—à—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –æ—Ç—Ä–∏–º—É—é—Ç—å toast "–î–∞–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–æ - {–Ü–º'—è} –∑–±–µ—Ä—ñ–≥ –∑–º—ñ–Ω–∏"
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫–æ–∂–Ω—ñ 10 —Å–µ–∫—É–Ω–¥ (–ª–µ–≥–∫–∏–π –∑–∞–ø–∏—Ç - —Ç—ñ–ª—å–∫–∏ timestamp)
- –ù–ï —Å–∫—Ä–æ–ª–∏—Ç—å —Å—Ç–æ—Ä—ñ–Ω–∫—É, –ù–ï –∑–±–∏–≤–∞—î —ñ–Ω—à—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è

### 5. –ú–æ–±—ñ–ª—å–Ω–∞ –∞–¥–∞–ø—Ç–∞—Ü—ñ—è üì±
- –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ –∫–Ω–æ–ø–∫–∏ +/- –≤ –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü—ñ—ó
- –•–µ–¥–µ—Ä –∞–¥–∞–ø—Ç–æ–≤–∞–Ω–∏–π –¥–ª—è –º–æ–±—ñ–ª—å–Ω–∏—Ö

### 6. Email –¥–ª—è –≤—Å—ñ—Ö –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ üìß
- –í—Å—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏ —Ç–µ–ø–µ—Ä –º–∞—é—Ç—å –∫–Ω–æ–ø–∫—É "Email –∫–ª—ñ—î–Ω—Ç—É"

## –§–∞–π–ª–∏:

### Frontend (rentalhub.farforrent.com.ua)
- `/frontend/` - –≥–æ—Ç–æ–≤—ñ —Å—Ç–∞—Ç–∏—á–Ω—ñ —Ñ–∞–π–ª–∏ –¥–ª—è –¥–µ–ø–ª–æ—é

### Backend (backrentalhub.farforrent.com.ua)
- `/backend/` - –ø–æ–≤–Ω–∏–π –±–µ–∫–µ–Ω–¥ –∑ –Ω–æ–≤–∏–º–∏ —Ä–æ—É—Ç–∞–º–∏

## –ù–æ–≤—ñ —Ñ–∞–π–ª–∏ –±–µ–∫–µ–Ω–¥—É:
- `routes/order_internal_notes.py` - API –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ–≥–æ —á–∞—Ç—É
- `routes/order_sync.py` - API —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó –∑–º—ñ–Ω
- `routes/order_modifications.py` - API –¥–æ–∑–∞–º–æ–≤–ª–µ–Ω—å
- `services/doc_engine/data_builders.py` - –æ–Ω–æ–≤–ª–µ–Ω–∏–π –∑ damage_breakdown
- `templates/documents/damage_breakdown/v1.html` - —à–∞–±–ª–æ–Ω –¥–æ–∫—É–º–µ–Ω—Ç–∞

## –ù–æ–≤—ñ —Ñ–∞–π–ª–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É:
- `hooks/useAutoRefresh.js` - —Ö—É–∫ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó (useOrderSync)
- `components/order-workspace/InternalNotesChat.jsx` - —á–∞—Ç –∫–æ–º–∞–Ω–¥–∏

## –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö - –Ω–æ–≤—ñ —Ç–∞–±–ª–∏—Ü—ñ/–∫–æ–ª–æ–Ω–∫–∏:

### –¢–∞–±–ª–∏—Ü—è order_internal_notes:
```sql
CREATE TABLE IF NOT EXISTS order_internal_notes (
    id INT AUTO_INCREMENT PRIMARY KEY,
    order_id VARCHAR(50) NOT NULL,
    user_id VARCHAR(100),
    user_name VARCHAR(255),
    message TEXT NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_order_id (order_id),
    INDEX idx_created_at (created_at)
);
```

### –ö–æ–ª–æ–Ω–∫–∏ –≤ orders (–¥–æ–¥–∞—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ):
```sql
ALTER TABLE orders 
ADD COLUMN IF NOT EXISTS updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
ADD COLUMN IF NOT EXISTS modified_by VARCHAR(255);
```
